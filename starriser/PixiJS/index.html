<!DOCTYPE html>
<html>
<head>
	<title>Ahhhhh ahhhh ah hhhahhahahahahahhahahahhhhhsfghfghjgkhjrkhs hjdlÂ´jsi</title>
	<script type="text/javascript" src="pixi.js"></script>
	<style type="text/css">
		* {
			margin: 0 auto;
			padding: 0 auto;
		}
	</style>
</head>
<body style="background: black;">
	<!--<canvas id="canvas"></canvas>-->
	<script type="text/javascript">

PIXI.WebGLGraphics.buildLine = function(graphicsData, webGLData) {

    var i = 0;
    var points = graphicsData.points;

    if (points.length === 0) return;

    // if the line width is an odd number add 0.5 to align to a whole pixel
    if (graphicsData.lineWidth % 2)
    {
        for (i = 0; i < points.length; i++) {
            points[i] += 0.5;
        }
    }

    var verts = webGLData.points;
    var indices = webGLData.indices;
    var length = points.length / 2;
    var indexCount = points.length;
    var indexStart = verts.length / 6;

    // sort color
    var color = PIXI.hex2rgb(graphicsData.lineColor);
    var alpha = graphicsData.lineAlpha;
    var r = color[0] * alpha;
    var g = color[1] * alpha;
    var b = color[2] * alpha;

    var p1x, p1y, p2x, p2y;

    for (i = 1; i < length - 1; i++) {
        p1x = points[(i - 1) * 2];
        p1y = points[(i - 1) * 2 + 1];

        p2x = points[i * 2];
        p2y = points[i * 2 + 1];

        verts.push(p1x , p1y);
        verts.push(r, g, b, alpha);

        verts.push(p2x, p2y);
        verts.push(r, g, b, alpha);
    }

    indices.push(indexStart);

    for (i = 0; i < indexCount - 4; i++) {
        indices.push(indexStart++);
    }

    indices.push(indexStart - 1);
};

PIXI.WebGLGraphics.renderGraphics = function(graphics, renderSession) {
	var gl = renderSession.gl;
	var projection = renderSession.projection,
		offset = renderSession.offset,
		shader = renderSession.shaderManager.primitiveShader,
		webGLData;
	if (graphics.dirty) {
		PIXI.WebGLGraphics.updateGraphics(graphics, gl);
	}
	var webGL = graphics._webGL[gl.id];
	// This could be speeded up for sure!
	for (var i = 0; i < webGL.data.length; i++) {
		webGLData = webGL.data[i];
		renderSession.shaderManager.setShader( shader );//activatePrimitiveShader();
		shader = renderSession.shaderManager.primitiveShader;
		gl.uniformMatrix3fv(shader.translationMatrix, false, graphics.worldTransform.toArray(true));
		gl.uniform2f(shader.projectionVector, projection.x, -projection.y);
		gl.uniform2f(shader.offsetVector, -offset.x, -offset.y);
		gl.uniform3fv(shader.tintColor, PIXI.hex2rgb(graphics.tint));
		gl.uniform1f(shader.alpha, graphics.worldAlpha);
		gl.bindBuffer(gl.ARRAY_BUFFER, webGLData.buffer);
		gl.vertexAttribPointer(shader.aVertexPosition, 2, gl.FLOAT, false, 4 * 6, 0);
		gl.vertexAttribPointer(shader.colorAttribute, 4, gl.FLOAT, false,4 * 6, 2 * 4);
		// set the index buffer!
		gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, webGLData.indexBuffer);
		gl.drawElements(gl.LINE_STRIP, webGLData.indices.length, gl.UNSIGNED_SHORT, 0 );
	}
};


var flipflop = (function () {

	var bool = true;

	return function () {
		bool = !bool;
		return bool;
	}
})();

	var renderer = PIXI.autoDetectRenderer(2000, 1000, {antialias: true, transparent: true});

	document.body.appendChild(renderer.view);

	function line (color, stage) {

		this.graphics = new PIXI.Graphics();

		this.graphics.lineStyle(2, 0xFFFFFF);

		this.graphics.moveTo(
			Math.round(Math.random()*1000),
			Math.round(Math.random()*1000)
		);

		for (var i = 20000 - 1; i >= 0; i--) {

			this.graphics.lineTo(
				Math.round(Math.random()*1000),
				Math.round(Math.random()*1000)
			);
		}

		this.vector = {
			x: Math.random() - 2,
			y: Math.random() - 2
		};

		this.graphics.position.x = 0;
		this.graphics.position.y = 0;

		this.scale = this.graphics.scale;

		stage.addChild(this.graphics);
	}

	line.prototype.move = function() {
		this.graphics.position.x += this.vector.x;
		this.graphics.position.y += this.vector.y;
	};

	var lines = [];

	var stage = new PIXI.Stage;

	for (var i = 0; i < 1; i++) {
		lines.push(new line(0xFFFFFF, stage));
	}

	function draw() {
		var t = window.performance.now();
		var sin = Math.sin(t/500);
		requestAnimationFrame(draw);
		for (var i = lines.length - 1; i >= 0; i--) {
			//lines[i].graphics.rotation += 0.01;
			lines[i].graphics.scale.y *= 1.001;
			lines[i].graphics.scale.x *= 1.001;
			lines[i].move();
		}
		renderer.render(stage);
		document.title = window.performance.now() - t;
	}

	draw();

	</script>
</body>
</html>
